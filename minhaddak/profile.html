<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Profile</title>
<style>
  body { font-family: Arial, sans-serif; background: #f2f2f2; padding: 20px; }
  .profile-container { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);}
  .profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; }
  .profile-header img { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; }
  .profile-info h2 { margin: 0; }
  .profile-info p { margin: 5px 0; }
  .profile-gallery { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px; }
  .profile-gallery img { width: 48%; border-radius: 8px; object-fit: cover; }
</style>
</head>
<body>

<div class="profile-container">
  <div class="profile-header">
    <img id="profilePic" src="" alt="Profile Picture">
    <div class="profile-info">
      <h2 id="name"></h2>
      <p><b>Address:</b> <span id="address"></span></p>
      <p><b>Profession:</b> <span id="profession"></span></p>
      <p><b>Phone:</b> <span id="phone"></span></p>
    </div>
  </div>

  <h3>Gallery</h3>
  <div class="profile-gallery" id="gallery">
    <!-- user images will be injected here -->
  </div>
</div>

<script>
const APP_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxFxu-CUfNmOuWvzf7akHO30iEjJucXKrkzfoN_ul6-LmuZt2eWdejCjiA_j1Coc88o/exec";

// get logged-in user phone from localStorage
// TEST PURPOSE: simulate a logged-in user
localStorage.setItem("userPhone", "684"); // replace with an actual phone from your sheet

const phone = localStorage.getItem("userPhone");
if(!phone){
  alert("Not logged in!");
  window.location.href = "login.html";
}

// now fetch profile data using phone


async function loadProfile() {
  try {
    let res = await fetch(APP_SCRIPT_URL);
    let data = await res.json();

    const user = data.find(u => u.Phone === phone);
    if(!user){
      alert("User not found!");
      return;
    }

    document.getElementById("name").innerText = user.Name;
    document.getElementById("address").innerText = user.Address;
    document.getElementById("profession").innerText = user.Profession;
    document.getElementById("phone").innerText = user.Phone;
    document.getElementById("profilePic").src = user.ProfilePic;

    const gallery = document.getElementById("gallery");
    user.Images.forEach(url => {
      const img = document.createElement("img");
      img.src = url;
      gallery.appendChild(img);
    });

  } catch(err){
    console.error(err);
    alert("Error loading profile: " + err.message);
  }
}

// load the profile on page load
loadProfile();
</script>

</body>
</html>
